basePath: /
definitions:
  controllers.LoginInput:
    properties:
      email:
        type: string
      password:
        type: string
    required:
    - email
    - password
    type: object
  controllers.ProductInput:
    properties:
      category:
        $ref: '#/definitions/models.ProductCategory'
      description:
        type: string
      image_url:
        type: string
      name:
        type: string
      purchase_price:
        type: number
      selling_price:
        type: number
      stock:
        type: integer
    required:
    - category
    - name
    - purchase_price
    - selling_price
    - stock
    type: object
  controllers.RegisterInput:
    properties:
      email:
        type: string
      name:
        type: string
      password:
        type: string
    required:
    - email
    - name
    - password
    type: object
  controllers.ShopInput:
    properties:
      email:
        type: string
      name:
        type: string
      password:
        minLength: 6
        type: string
      whatsapp_number:
        type: string
    required:
    - email
    - name
    - password
    - whatsapp_number
    type: object
  controllers.TransactionExpenseInput:
    properties:
      amount:
        type: number
    type: object
  controllers.TransactionSaleInput:
    properties:
      product_id:
        type: integer
      quantity:
        type: integer
    type: object
  controllers.TransactionWithdrawalInput:
    properties:
      amount:
        type: number
    type: object
  controllers.UpdateWhatsAppInput:
    properties:
      whatsapp_number:
        type: string
    required:
    - whatsapp_number
    type: object
  models.ProductCategory:
    enum:
    - Phone
    - Television
    - Charger
    - Computer
    - Peripheral
    type: string
    x-enum-varnames:
    - Phone
    - Television
    - Charger
    - Computer
    - Peripheral
  services.DashboardResponse:
    properties:
      low_stock_products:
        type: integer
      net_profit:
        type: number
      total_expenses:
        type: number
      total_sales:
        type: number
      total_withdrawals:
        type: number
    type: object
  services.TransactionResponse:
    properties:
      amount:
        type: number
      created_at:
        type: string
      id:
        type: integer
      product_id:
        type: integer
      quantity:
        type: integer
      type:
        type: string
    type: object
host: localhost:8080
info:
  contact: {}
  description: Backend multi-tenant for electronics shops
  title: MultiShop API
  version: "1.0"
paths:
  /api/login:
    post:
      consumes:
      - application/json
      description: Authenticate user and return JWT
      parameters:
      - description: Login data
        in: body
        name: input
        required: true
        schema:
          $ref: '#/definitions/controllers.LoginInput'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties: true
            type: object
      summary: Login user
      tags:
      - Auth
  /api/products:
    get:
      description: Returns all products belonging to the authenticated user's shop.
        SuperAdmin can see PurchasePrice, Admin cannot.
      produces:
      - application/json
      responses:
        "200":
          description: List of products
          schema:
            additionalProperties: true
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties: true
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties: true
            type: object
        "500":
          description: Internal server error
          schema:
            additionalProperties: true
            type: object
      security:
      - BearerAuth: []
      summary: Get all products of the current shop
      tags:
      - Products
    post:
      consumes:
      - application/json
      description: Allows an Admin or SuperAdmin to create a new product in their
        shop. Product name must be unique per shop.
      parameters:
      - description: Product creation payload
        in: body
        name: input
        required: true
        schema:
          $ref: '#/definitions/controllers.ProductInput'
      produces:
      - application/json
      responses:
        "201":
          description: Product created successfully
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Invalid input
          schema:
            additionalProperties: true
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties: true
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties: true
            type: object
        "500":
          description: Internal server error
          schema:
            additionalProperties: true
            type: object
      security:
      - BearerAuth: []
      summary: Create a new product
      tags:
      - Products
  /api/products/{id}:
    delete:
      description: Allows a SuperAdmin to delete a product belonging to their shop.
      parameters:
      - description: Product ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Product deleted successfully
          schema:
            additionalProperties: true
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties: true
            type: object
        "403":
          description: Forbidden - SuperAdmin only
          schema:
            additionalProperties: true
            type: object
        "500":
          description: Internal server error
          schema:
            additionalProperties: true
            type: object
      security:
      - BearerAuth: []
      summary: Delete a product
      tags:
      - Products
    put:
      consumes:
      - application/json
      description: Allows Admin or SuperAdmin to update a product belonging to their
        shop. Product name must remain unique. Only SuperAdmin can update PurchasePrice.
      parameters:
      - description: Product ID
        in: path
        name: id
        required: true
        type: integer
      - description: Updated product payload
        in: body
        name: input
        required: true
        schema:
          $ref: '#/definitions/controllers.ProductInput'
      produces:
      - application/json
      responses:
        "200":
          description: Product updated successfully
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Invalid input or product not found
          schema:
            additionalProperties: true
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties: true
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties: true
            type: object
      security:
      - BearerAuth: []
      summary: Update an existing product
      tags:
      - Products
  /api/public/{shopID}/products:
    get:
      description: Returns the list of publicly visible products for a specific shop.
        PurchasePrice is never exposed. Accessible without authentication.
      parameters:
      - description: Shop ID
        in: path
        name: shopID
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: List of public products
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Invalid shop ID
          schema:
            additionalProperties: true
            type: object
        "404":
          description: Shop not found or inactive
          schema:
            additionalProperties: true
            type: object
      summary: Get public products of a shop
      tags:
      - Public
  /api/public/{shopID}/products/{productID}/whatsapp:
    get:
      description: Generates a dynamic WhatsApp link for a specific product of a given
        shop. Accessible without authentication.
      parameters:
      - description: Shop ID
        in: path
        name: shopID
        required: true
        type: integer
      - description: Product ID
        in: path
        name: productID
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Generated WhatsApp link
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: Invalid shop or product ID
          schema:
            additionalProperties: true
            type: object
        "404":
          description: Shop or product not found
          schema:
            additionalProperties: true
            type: object
      summary: Generate WhatsApp link for a product
      tags:
      - Public
  /api/public/shop:
    get:
      description: Retrieves a list of all shops with their basic details. Accessible
        without authentication.
      produces:
      - application/json
      responses:
        "200":
          description: List of shops
          schema:
            items:
              additionalProperties: true
              type: object
            type: array
        "500":
          description: Internal server error
          schema:
            additionalProperties: true
            type: object
      summary: Get list of all shops
      tags:
      - Public
    post:
      consumes:
      - application/json
      description: Creates a new shop along with a SuperAdmin user. The provided email
        must be unique across all users.
      parameters:
      - description: Shop creation payload
        in: body
        name: input
        required: true
        schema:
          $ref: '#/definitions/controllers.ShopInput'
      produces:
      - application/json
      responses:
        "201":
          description: Shop and SuperAdmin created successfully
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Invalid input or email already exists
          schema:
            additionalProperties: true
            type: object
      summary: Create a new shop with SuperAdmin
      tags:
      - Public
  /api/reports/dashboard:
    get:
      description: Returns financial metrics for the authenticated SuperAdmin's shop
        including total sales, expenses, withdrawals, net profit and low stock products.
      produces:
      - application/json
      responses:
        "200":
          description: Financial dashboard data
          schema:
            $ref: '#/definitions/services.DashboardResponse'
        "401":
          description: Unauthorized
          schema:
            additionalProperties: true
            type: object
        "403":
          description: Forbidden - SuperAdmin only
          schema:
            additionalProperties: true
            type: object
        "500":
          description: Internal server error
          schema:
            additionalProperties: true
            type: object
      security:
      - BearerAuth: []
      summary: Get financial dashboard of the shop
      tags:
      - Reports
  /api/shop/whatsapp:
    patch:
      consumes:
      - application/json
      description: Allows a SuperAdmin to update the WhatsApp number of their shop.
      parameters:
      - description: New WhatsApp number
        in: body
        name: input
        required: true
        schema:
          $ref: '#/definitions/controllers.UpdateWhatsAppInput'
      produces:
      - application/json
      responses:
        "200":
          description: WhatsApp number updated
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Invalid input
          schema:
            additionalProperties: true
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties: true
            type: object
        "403":
          description: Forbidden - SuperAdmin only
          schema:
            additionalProperties: true
            type: object
      security:
      - BearerAuth: []
      summary: Update shop WhatsApp number
      tags:
      - Shop
  /api/transactions:
    get:
      description: Returns all transactions (Sale, Expense, Withdrawal) belonging
        to the authenticated user's shop.
      produces:
      - application/json
      responses:
        "200":
          description: List of transactions
          schema:
            items:
              $ref: '#/definitions/services.TransactionResponse'
            type: array
        "401":
          description: Unauthorized
          schema:
            additionalProperties: true
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties: true
            type: object
        "500":
          description: Internal server error
          schema:
            additionalProperties: true
            type: object
      security:
      - BearerAuth: []
      summary: Get all transactions of the current shop
      tags:
      - Transactions
  /api/transactions/{id}:
    delete:
      description: Allows Admin or SuperAdmin to delete a transaction belonging to
        their shop. If the transaction is a Sale, the product stock is restored automatically.
      parameters:
      - description: Transaction ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Transaction deleted successfully
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Transaction not found
          schema:
            additionalProperties: true
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties: true
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties: true
            type: object
      security:
      - BearerAuth: []
      summary: Delete a transaction
      tags:
      - Transactions
  /api/transactions/expense:
    post:
      consumes:
      - application/json
      description: Allows Admin or SuperAdmin to create an Expense transaction. The
        request must include the amount of the expense.
      parameters:
      - description: Transaction payload
        in: body
        name: input
        required: true
        schema:
          $ref: '#/definitions/controllers.TransactionExpenseInput'
      produces:
      - application/json
      responses:
        "201":
          description: Transaction created successfully
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Invalid input
          schema:
            additionalProperties: true
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties: true
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties: true
            type: object
      security:
      - BearerAuth: []
      summary: Create a new Expense transaction
      tags:
      - Transactions
  /api/transactions/sale:
    post:
      consumes:
      - application/json
      description: Allows Admin or SuperAdmin to create a Sale transaction. The request
        must include the product ID and quantity. The system will automatically calculate
        the total amount based on the product price and quantity, and reduce the product
        stock accordingly.
      parameters:
      - description: Transaction payload
        in: body
        name: input
        required: true
        schema:
          $ref: '#/definitions/controllers.TransactionSaleInput'
      produces:
      - application/json
      responses:
        "201":
          description: Transaction created successfully
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Invalid input, insufficient stock, or product not found
          schema:
            additionalProperties: true
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties: true
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties: true
            type: object
      security:
      - BearerAuth: []
      summary: Create a new Sale transaction
      tags:
      - Transactions
  /api/transactions/withdrawal:
    post:
      consumes:
      - application/json
      description: Allows Admin or SuperAdmin to create a Withdrawal transaction.
        The request must include the amount of the withdrawal.
      parameters:
      - description: Transaction payload
        in: body
        name: input
        required: true
        schema:
          $ref: '#/definitions/controllers.TransactionWithdrawalInput'
      produces:
      - application/json
      responses:
        "201":
          description: Transaction created successfully
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Invalid input
          schema:
            additionalProperties: true
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties: true
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties: true
            type: object
      security:
      - BearerAuth: []
      summary: Create a new Withdrawal transaction
      tags:
      - Transactions
  /api/users:
    get:
      description: Allows a SuperAdmin to retrieve all users belonging to their shop.
        Only id, email and role are returned.
      produces:
      - application/json
      responses:
        "200":
          description: List of users
          schema:
            additionalProperties: true
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties: true
            type: object
        "403":
          description: Forbidden - SuperAdmin only
          schema:
            additionalProperties: true
            type: object
        "500":
          description: Internal server error
          schema:
            additionalProperties: true
            type: object
      security:
      - BearerAuth: []
      summary: Get all users of the current shop
      tags:
      - Users
    post:
      consumes:
      - application/json
      description: Allows a SuperAdmin to create a new Admin user in their own shop.
        Role is automatically set to Admin.
      parameters:
      - description: Admin creation payload
        in: body
        name: input
        required: true
        schema:
          $ref: '#/definitions/controllers.RegisterInput'
      produces:
      - application/json
      responses:
        "201":
          description: Admin successfully created
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Invalid input or creation error
          schema:
            additionalProperties: true
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties: true
            type: object
        "403":
          description: Forbidden - SuperAdmin only
          schema:
            additionalProperties: true
            type: object
      security:
      - BearerAuth: []
      summary: Create a new Admin user
      tags:
      - Users
  /api/users/{id}:
    delete:
      description: Allows a SuperAdmin to delete a user belonging to their shop.
      parameters:
      - description: User ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: User deleted successfully
          schema:
            additionalProperties: true
            type: object
        "400":
          description: User not found
          schema:
            additionalProperties: true
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties: true
            type: object
        "403":
          description: Forbidden - SuperAdmin only
          schema:
            additionalProperties: true
            type: object
      security:
      - BearerAuth: []
      summary: Delete a user
      tags:
      - Users
    patch:
      consumes:
      - application/json
      description: Allows a SuperAdmin to update the role of a user belonging to their
        shop. Only Admin or SuperAdmin roles are allowed.
      parameters:
      - description: User ID
        in: path
        name: id
        required: true
        type: integer
      - description: Role update payload (Admin or SuperAdmin)
        in: body
        name: input
        required: true
        schema:
          properties:
            role:
              type: string
          type: object
      produces:
      - application/json
      responses:
        "200":
          description: Role updated successfully
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Invalid role or user not found
          schema:
            additionalProperties: true
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties: true
            type: object
        "403":
          description: Forbidden - SuperAdmin only
          schema:
            additionalProperties: true
            type: object
      security:
      - BearerAuth: []
      summary: Update user role
      tags:
      - Users
  /public/categories:
    get:
      description: Returns all allowed product categories.
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              type: string
            type: array
      summary: Get available product categories
      tags:
      - Public
securityDefinitions:
  BearerAuth:
    in: header
    name: Authorization
    type: apiKey
swagger: "2.0"
